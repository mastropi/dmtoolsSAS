<!DOCTYPE html>

<html>
<head>
<title>%Means</title>
<style>
pre {display: block}
</style>
<body>
<h1>MACRO %Means</h1>
<pre>Version:                      1.19                                                                                      </pre>
<pre>Author:                       Daniel Mastropietro                                                                       </pre>
<pre>Created:                      01-Sep-2000                                                                               </pre>
<pre>Modified:                     10-Jan-2018 (previous: 28-Nov-2017, 06-Sep-2017, 24-Aug-2017, 21-Apr-2016, 04-Feb-2016)                                                            </pre>
<pre>                                                                                                                        </pre>
<h3>DESCRIPTION:</h3>
<pre>Runs PROC MEANS with the statements and options "usually" used. The supported statements are:                                                                                          </pre>
<pre>- format                                                                                                                </pre>
<pre>- class                                                                                                                 </pre>
<pre>- by                                                                                                                    </pre>
<pre>- id                                                                                                                    </pre>
<pre>- weight                                                                                                                </pre>
<pre>- output                                                                                                                </pre>
<pre>                                                                                                                        </pre>
<pre>In addition to specifying these statements, the following options can be specified:                                                                                          </pre>
<pre>- The statistics to be computed.                                                                                          </pre>
<pre>- The names to be given to the variables containing the requested statistics in the output                                                                                          </pre>
<pre>dataset.                                                                                                                </pre>
<pre>- Suffixes to be used when naming the variables containing the requested statistics in the                                                                                          </pre>
<pre>output dataset.                                                                                                         </pre>
<pre>- An option specyfing whether or not the result of the procedure should be shown in the                                                                                          </pre>
<pre>output window.                                                                                                          </pre>
<pre>- Options used in the PROC MEANS statement                                                                                          </pre>
<pre>- Additional options used in the OUTPUT statement.                                                                                          </pre>
<pre>- Request transposition of the output dataset generated by PROC MEANS so that the results                                                                                          </pre>
<pre>are distributed one row per analysis variable and one column per statistic requested.                                                                                          </pre>
<pre>                                                                                                                        </pre>
<pre>In order to avoid writing some statements repeatedly (as is the case when using PROC MEANS                                                                                          </pre>
<pre>directly) this macro drops by default the variables _TYPE_ and _FREQ_ from the output dataset,                                                                                          </pre>
<pre>which are seldom useful.                                                                                                </pre>
<pre>                                                                                                                        </pre>
<h3>USAGE:</h3>
<pre>%Means(                                                                                             </pre>
<pre>          data,                         /* Input dataset */                                         </pre>
<pre>          out=,                         /* Output dataset */                                        </pre>
<pre>          var=_NUMERIC_, /* Variables on which statistics are computed */                                                            </pre>
<pre>          format=,                      /* PROC MEANS FORMAT statement */                              </pre>
<pre>          id=,                          /* PROC MEANS ID statement */                               </pre>
<pre>          by=,                          /* PROC MEANS BY statement */                               </pre>
<pre>          class=,                       /* PROC MEANS CLASS statement */                              </pre>
<pre>          types=,                       /* PROC MEANS TYPES statement */                              </pre>
<pre>          stat=n nmiss mean stddev cv skewness kurtosis min p1 p5 p10 p25 p50 p75 p90 p95 p99 max,                                                            </pre>
<pre>          /* Statistics to be computed on the variables */                                                            </pre>
	name=,			*** Names to be used for the requested statistics
<pre>          name=,                        /* Names to be used for the requested statistics */                              </pre>
<pre>          prefix=,                      /* Prefixes to be added to the above names */                              </pre>
<pre>          suffix=,                      /* Suffixes to be added to the above names */                              </pre>
<pre>          weight=,                      /* PROC MEANS WEIGHT statement */                              </pre>
<pre>          options=,                     /* PROC MEANS statement options */                              </pre>
<pre>          optionsout=,                  /* Additional PROC MEANS OUTPUT statement options */                              </pre>
<pre>          transpose=0,                  /* Transpose the output dataset to have one row per variable? */                              </pre>
<pre>          namevar=_var_,                /* If transpose=1, name for the column with the variable names */                              </pre>
<pre>          /* in the output dataset */                                                               </pre>
<pre>          droptypefreq=1,               /* Drop the _TYPE_AND _FREQ_ variables from the output dataset? */                              </pre>
<pre>          sortinplace=1,                /* Sort the input dataset in place when there are BY variables? */                              </pre>
<pre>          noprint=1,                    /* Show results in the output window? */                              </pre>
<pre>          nolabel=1,                    /* Avoid labels on variables with the summary statistics? */                              </pre>
<pre>          notes=1,                      /* Show SAS notes in the log? */                              </pre>
<pre>          log=1);                       /* Show messages in the log? */                              </pre>
<pre>                                                                                                    </pre>
<h3>REQUESTED PARAMETERS:</h3>
<pre>- data:   Input dataset. It can contain additional options as in any data=                                                            </pre>
<pre>          option in SAS (such as keep=, where=, etc.).                                                            </pre>
<pre>                                                                                                    </pre>
<h3>OPTIONAL PARAMETERS:</h3>
<pre>- out:    Output dataset containing the statistics requested.                                                            </pre>
<pre>          It can contain additional options as in any data= option in SAS.                                                            </pre>
<pre>          By default, if this parameter is passed, the 'noprint'                                                            </pre>
<pre>          option is used so that nothing is shown in the output window.                                                             </pre>
<pre>          If no value is passed, the results are shown in the output window.                                                            </pre>
<pre>          The format of the output dataset depends on the value of parameter                                                            </pre>
<pre>          'transpose'.                                                                              </pre>
<pre>          - If transpose=0:                                                                         </pre>
<pre>          There is one row for each by variable combination and one                                                            </pre>
<pre>          column for each variable-statistic combination. (See examples below)                                                            </pre>
<pre>          - If transpose=1:                                                                         </pre>
<pre>          The output is in table format, mimicing the format used by PROC MEANS                                                            </pre>
<pre>          to show the results in the output window. That is:                                                            </pre>
<pre>          - if no by variables are used, there is one row for each variable                                                            </pre>
<pre>          listed in 'var' and one column for each statistic listed in 'stat',                                                            </pre>
<pre>          plus one column for the variable name corresponding to each row.                                                            </pre>
<pre>          - if by variables are used, the structure just described is repeated                                                            </pre>
<pre>          for each combination of the values of the by variables. In this case,                                                            </pre>
<pre>          the first columns of the dataset are the by variables and the                                                            </pre>
<pre>          column containing the variable names.                                                            </pre>
<pre>          Notes:                                                                                    </pre>
<pre>          - The name for the column containing the variable names is specified                                                            </pre>
<pre>          in parameter 'namevar' (see below when parameter 'namevar' is described).                                                            </pre>
<pre>          - Variables _TYPE_ and _FREQ_ generated by PROC MEANS are dropped by default                                                            </pre>
<pre>          from the output dataset.                                                                  </pre>
<pre>                                                                                                    </pre>
<pre>- var:    List of variables on which the requested statistics are                                                            </pre>
<pre>          computed.                                                                                 </pre>
<pre>          default: _numeric_, i.e. all numeric variables are used                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- format: Format definition for the variables.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- by:     List of variables to be used in the BY statement.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- class:  List of variables to be used in the CLASS statement.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- types:  TYPES statement identifying which analysis types of the class variables to run.                                                            </pre>
<pre>          Ex: grp1*grp2*grp3 (assuming the class variables are grp1 grp2 grp3)                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- id:     List of variables to be used in the ID statement.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- stat:   List of statistics to be computed on the variables listed                                                            </pre>
<pre>          in 'var'.                                                                                 </pre>
<pre>          default: n nmiss mean stddev cv skewness kurtosis min p1 p5 p10 p25 p50 p75 p90 p95 p99 max                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- name:   List of names to be given to each statistic specified in the 'stat'                                                            </pre>
<pre>          parameter.                                                                                </pre>
<pre>          There are 3 ways of using this parameter:                                                            </pre>
<pre>          (1) By giving a list of as many names as statistics produced                                                            </pre>
<pre>          (the number of statistics produced is the product of the number                                                            </pre>
<pre>          of variables in 'var' and the number of statistics in 'stat').                                                            </pre>
<pre>          The order in which the names should be specified is by first cycling                                                            </pre>
<pre>          on the variable names and then on the statistic keywords. For ex:                                                            </pre>
<pre>          If 'var=x y' and 'stat=mean std', meaningful names are specified with                                                            </pre>
<pre>          'name=xmean ymean xstd ystd'.                                                             </pre>
<pre>          (2) By using it in conjunction with parameter 'prefix' or 'suffix', in                                                            </pre>
<pre>          which case parameter 'name' must contain as many names as variables                                                            </pre>
<pre>          specified in 'var'. See description of parameter 'suffix' for an                                                            </pre>
<pre>          explanation of how the names are built up.                                                            </pre>
<pre>          (3) Do not specify any value. In this case, the names for the requested                                                            </pre>
<pre>          statistics are formed as follows:                                                            </pre>
<pre>          - if parameter 'prefix' or 'suffix' is specified, follow their naming rule.                                                            </pre>
<pre>          - otherwise, the AUTONAME option in the output statement of PROC MEANS                                                            </pre>
<pre>          is used.                                                                                  </pre>
<pre>          This parameter has no effect if 'out' is empty or transpose=1.                                                            </pre>
<pre>          SEE EXAMPLES BELOW.                                                                       </pre>
<pre>                                                                                                    </pre>
<pre>- prefix: List of prefixes to be used for naming the requested statistics.                                                            </pre>
<pre>          This parameter has no effect if 'out' is empty or transpose=1.                                                            </pre>
<pre>          See parameter 'suffix' for an explanation of how it works.                                                            </pre>
<pre>          SEE EXAMPLES BELOW.                                                                       </pre>
<pre>                                                                                                    </pre>
<pre>- suffix: List of suffixes to be used for naming the requested statistics.                                                            </pre>
<pre>          The list must contain as many suffixes as statistics requested in 'stat'.                                                            </pre>
<pre>          It works as follows:                                                                      </pre>
<pre>          - If parameter 'name' is empty, a suffix is added to each variable                                                            </pre>
<pre>          name given in 'var' corresponding to each statistic requested in                                                            </pre>
<pre>          'stat'.                                                                                   </pre>
<pre>          - If parameter 'name' is specified, the suffix is added to each name                                                            </pre>
<pre>          in 'name' instead of to each variable name in 'var'. (Parameter 'name'                                                            </pre>
<pre>          must contain as many names as variables specified in 'var'.)                                                            </pre>
<pre>          This parameter has no effect if 'out' is empty or transpose=1.                                                            </pre>
<pre>          SEE EXAMPLES BELOW.                                                                       </pre>
<pre>                                                                                                    </pre>
<pre>- weight: Variable to be used in the WEIGHT statement.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- options:Options to be used in the PROC MEANS statement.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- optionsout:Options to be used in the OUTPUT statement of PROC MEANS after the                                                            </pre>
<pre>          '/' symbol.                                                                               </pre>
<pre>                                                                                                    </pre>
<pre>- transpose:Indicates whether the output dataset containing the statistics is                                                            </pre>
<pre>          transposed from the default output generated by PROC MEANS.                                                            </pre>
<pre>          It has no effect if parameter 'out' is empty.                                                            </pre>
<pre>          See 'out' for details.                                                                    </pre>
<pre>          Possible values are: 0 => do not transpose, 1 => transpose                                                            </pre>
<pre>          default: 0 (i.e. the dataset is not transposed)                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- namevar:Name to use for the column containing the variable names in the output                                                            </pre>
<pre>          dataset when TRANSPOSE=1. It has no effect if parameter 'out' is empty.                                                            </pre>
<pre>          default: _var_                                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- droptypefreq:Indicates whether to drop the _TYPE_ and _FREQ_ variables from the output                                                            </pre>
<pre>          dataset.                                                                                  </pre>
<pre>          Possible values: 0 => No, 1 => Yes.                                                            </pre>
<pre>          default: 1                                                                                </pre>
<pre>                                                                                                    </pre>
<pre>- sortinplace:When there are BY variables, it indicates whether the input dataset should                                                            </pre>
<pre>          be sorted in place, as opposed to creating a local copy of the sorted data.                                                            </pre>
<pre>          This is useful when we want to leverage the call to the %Means macro                                                            </pre>
<pre>          to sort the input dataset. It also may come handy with large datasets                                                            </pre>
<pre>          that are processed on a database so that no copy of the data is created                                                            </pre>
<pre>          locally.                                                                                  </pre>
<pre>          default: 0                                                                                </pre>
<pre>                                                                                                    </pre>
<pre>- noprint:Parameter that establishes whether the results of PROC MEANS should                                                            </pre>
<pre>          be shown in the output window or not.                                                            </pre>
<pre>          Possible values: 0 => Show, 1 => Do not show.                                                            </pre>
<pre>          default: depends on parameter 'out'. If 'out' is empty the results                                                            </pre>
<pre>          are shown, otherwise they are not.                                                            </pre>
<pre>                                                                                                    </pre>
<pre>- nolabel Indicates whether not to use labels on the variables with the summary                                                            </pre>
<pre>          statistics. The reason is that by default PROC MEANS transfers the                                                            </pre>
<pre>          labels of the analyzed variables ot the summary statistic variables                                                            </pre>
<pre>          and this may be a little cumbersome since we will not be able to                                                            </pre>
<pre>          distinguish the summary statistics among them and from the original                                                            </pre>
<pre>          variable.                                                                                 </pre>
<pre>          Possible values: 0 => No, 1 => Yes.                                                            </pre>
<pre>          default: 1                                                                                </pre>
<pre>                                                                                                    </pre>
<pre>- notes:  Indicates whether to show SAS notes in the log.                                                            </pre>
<pre>          The notes are shown only for the PROC MEANS step.                                                            </pre>
<pre>          Possible values: 0 => No, 1 => Yes.                                                            </pre>
<pre>          default: 1                                                                                </pre>
<pre>                                                                                                    </pre>
<pre>- log:    Indicates whether to show messages in the log.                                                            </pre>
<pre>          Possible values: 0 => No, 1 => Yes.                                                            </pre>
<pre>          default: 1                                                                                </pre>
<pre>                                                                                                    </pre>
<h3>NOTES:</h3>
<pre>1.- The variables _TYPE_ and _FREQ_ are dropped from the output dataset (if one is requested).                                                                                          </pre>
<pre>In order to keep them run PROC MEANS directly.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>2.- When TRANSPOSE=1, there should not be any variables appearing both in the BY= and the ID=, or                                                                                          </pre>
<pre>in the CLASS= and the ID= parameter specifications. Otherwise, the results from the computed                                                                                          </pre>
<pre>statistics will be most likely incorrect.                                                                                          </pre>
<pre>(This is because when the same variables appear in the BY and ID statements, or in the CLASS and                                                                                          </pre>
<pre>ID statements, SAS creates new variables in the output dataset generated by PROC MEANS (e.g. GROUP2,                                                                                          </pre>
<pre>if the BY variable and the ID variable is GROUP), and this messes up the transpose process.                                                                                          </pre>
<pre>The solution to this is not simple, that is why a note on this is shown.)                                                                                          </pre>
<pre>                                                                                                    </pre>
<h3>OTHER MACROS AND MODULES USED IN THIS MACRO:</h3>
<pre>- %Callmacro                                                                                          </pre>
<pre>- %CheckInputParameters                                                                                          </pre>
<pre>- %ExecTimeStart                                                                                          </pre>
<pre>- %ExecTimeStop                                                                                          </pre>
<pre>- %GetDataOptions                                                                                          </pre>
<pre>- %GetLibraryName                                                                                          </pre>
<pre>- %GetNobs                                                                                          </pre>
<pre>- %GetNroElements                                                                                          </pre>
<pre>- %GetVarList                                                                                          </pre>
<pre>- %GetVarNames                                                                                          </pre>
<pre>- %SetSASOptions                                                                                          </pre>
<pre>- %RemoveFromList                                                                                          </pre>
<pre>- %RemoveRepeated                                                                                          </pre>
<pre>- %ResetSASOptions                                                                                          </pre>
<pre>                                                                                                    </pre>
<h3>SEE ALSO:</h3>
<pre>- %FreqMult                                                                                          </pre>
<pre>                                                                                                    </pre>
<h3>EXAMPLES:</h3>
<pre>1.- %Means(A , out=A_stats , var=x y , stat=mean std cv, transpose=1, namevar=variable);                                                                                          </pre>
<pre>Computes the mean, standard deviation and coeff. of variation for variables x and y, and                                                                                           </pre>
<pre>stores them in dataset A_STATS. Since parameter transpose=1, the output dataset has 2 rows                                                                                          </pre>
<pre>and 4 columns:                                                                                          </pre>
<pre>- rows: the first contains the statistics for variable x; the second row contains the                                                                                          </pre>
<pre>statistics for variable y.                                                                                          </pre>
<pre>- columns: the column names are: variable mean std cv                                                                                          </pre>
<pre>No results are shown in the output window.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>This call is useful to have the output in table format. It is not useful to merge with                                                                                          </pre>
<pre>input dataset to include summary statistics.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>2.- %Means(A , out=A_stats , var=x y , stat=mean std cv , suffix=_mean _std _cv , noprint=0);                                                                                          </pre>
<pre>Computes the mean, standard deviation and coeff. of variation for variables x and y, and                                                                                           </pre>
<pre>stores them in dataset A_STATS. Since parameter transpose is not passed, it is assumed to be 0                                                                                          </pre>
<pre>and thus the output dataset has 1 row and 6 columns. The columns are named:                                                                                          </pre>
<pre>x_mean y_mean x_std y_std x_cv y_cv.                                                                                          </pre>
<pre>Since noprint=0, the results are shown in the output window.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>3.- %Means(A , out=A_stats , var=x y , stat=mean std cv , name=varX varY , suffix=_mean _std _cv);                                                                                          </pre>
<pre>Same as in Ex. 2, except the names of the variables containing the requested statistics                                                                                          </pre>
<pre>in the output dataset are: varX_mean varY_mean varX_std varY_std varX_cv varY_cv.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>4.- %Means(A , out=A_stats , var=x1 x2 , stat=mean std cv , prefix=mean_ std_ cv_ , noprint=0);                                                                                          </pre>
<pre>Same as Ex. 2, except the variable names are:                                                                                          </pre>
<pre>mean_x1 mean_x2 std_x1 std_x2 cv_x1 cv_x2.                                                                                          </pre>
<pre>Note that the use of a prefix is useful when the variables analyzed are many and are named                                                                                          </pre>
<pre>with a number at the end. For example if the analysis variables are x1, x2, x3, ..., x10,                                                                                          </pre>
<pre>using prefix=mean_ allows using the expression mean_x1-mean_x10 to reference the means                                                                                          </pre>
<pre>for all variables, x1 thru x10.                                                                                          </pre>
<pre>Since noprint=0, the results are shown in the output window.                                                                                          </pre>
<pre>                                                                                                    </pre>
<pre>5.- AVOIDING SUFFIX GENERATION IN A SINGLE STATISTIC COMPUTED                                                                                          </pre>
<pre>%Means(A , out=A_stats , var=x1 x2 , stat=sum , names=x1 x2 , suffix= , noprint=1);                                                                                          </pre>
<pre>Note that it is necessary to use the option NAMES=, since it is not enough to specify an empty                                                                                          </pre>
<pre>suffix. Specifying only the latter would generate the names for the statistics automatically                                                                                          </pre>
<pre>with the AUTONAME option of PROC MEANS.                                                                                          </pre>
<pre>Thus, this macro call will generate the dataset A_STATS with variables X1, X2 with the                                                                                          </pre>
<pre>sums of X1 and X2, respectively.                                                                                          </pre>
<pre>                                                                                                    </pre>
<h3>APPLICATIONS:</h3>
<pre>1.- Generate a table of statistics for several variables in form of a readable table, one statistic                                                                                          </pre>
<pre>per column and one analysis variable per row. To do this, use the TRANSPOSE=1 option.                                                                                          </pre>
<pre>Ex: Computing the distribution of a set of numeric variables.                                                                                          </pre>
<pre>%Means(                                                                                             </pre>
<pre>          A,                                                                                        </pre>
<pre>          var=x y z w t s,                                                                          </pre>
<pre>          out=Distribution,                                                                         </pre>
<pre>          transpose=1                                                                               </pre>
<pre>);                                                                                                  </pre>
<body>
</html>
