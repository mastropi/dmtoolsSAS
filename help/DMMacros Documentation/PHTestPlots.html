<!DOCTYPE html>

<html>
<head>
<title>%PHTestPlots</title>
<style>
pre {display: block}
</style>
<body>
<h1>MACRO %PHTestPlots</h1>
<pre>Version:                      1.01                                                                                      </pre>
<pre>Author:                       Daniel Mastropietro                                                                       </pre>
<pre>Created:                      29-Jul-2015                                                                               </pre>
<pre>Modified:                     20-Sep-2015 (previous: 29-Jul-2015)                                                            </pre>
<pre>SAS Version:                  9.4                                                                                       </pre>
<pre>                                                                                                                        </pre>
<h3>DESCRIPTION:</h3>
<pre>Generates plots to visually test the Proportional Hazards assumption for Cox Survival regression models                                                                                          </pre>
<pre>on a set of analysis variables.                                                                                          </pre>
<pre>The analysis variables are categorized in a few groups (e.g. 3 groups) and the Survival curve                                                                                          </pre>
<pre>is plotted on the same graph for each of these groups.                                                                                          </pre>
<pre>                                                                                                                        </pre>
<h3>USAGE:</h3>
<pre>%PHTestPlots(                                                                                          </pre>
<pre>          data ,                        /* Input dataset. */                                        </pre>
<pre>          target=, (REQUIRED)           /* Target variable containing the time to the event of interest. */                              </pre>
<pre>          censor=, (REQUIRED)           /* Censor variable containing the indicator of whether the observation is censored. */                              </pre>
<pre>          varclass=,                    /* List of categorical input variables to analyze. */                              </pre>
<pre>          varnum=,                      /* List of continuous input variables to analyze. */                              </pre>
<pre>          censorValue=1,                /* Value that indicates censored cases. */                              </pre>
<pre>          groups=3,                     /* Nro. of groups to use in the categorization of continuous variables. */                              </pre>
<pre>          method=KM,                    /* Method to use for the Survival function estimation. */                              </pre>
<pre>          alpha=0.05,                                                 /* Alpha level for confidence limits of the survival function. */</pre>
<pre>          odspath=,                     /* Quoted name of the path where all generated files should be saved. */                              </pre>
<pre>          odsfile=,                     /* Quoted name of the file where the plots are saved. */                              </pre>
<pre>          odsfiletype=html,             /* Type of the file specified in ODSFILE or output format. */                              </pre>
<pre>          imagerootname=PHTestPlot,     /* Root name to be used for the image file name generated by ODS graphics. */                              </pre>
<pre>          log=1);                       /* Show messages in log? */                                 </pre>
<pre>                                                                                                    </pre>
<h3>REQUIRED PARAMETERS:</h3>
<pre>- data:                       Input dataset. Data options can be specified as in a data= SAS option..                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- target:                     Target variable containing the time to the event of interest.                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- censor:                     Censor variable indicating whether the observation is censored.                                                            </pre>
<pre>                                                                                                                        </pre>
<h3>OPTIONAL PARAMETERS:</h3>
<pre>- varclass:                   List of categorical variables to analyze.                                                            </pre>
<pre>                              At least one of the VARCLASS= option or the VARNUM= option should be non-empty                                                            </pre>
<pre>                              to produce some graphs.                                                                   </pre>
<pre>                              default: empty                                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- varnum:                     List of continuous variables to analyze.                                                            </pre>
<pre>                              At least one of the VARCLASS= option or the VARNUM= option should be non-empty                                                            </pre>
<pre>                              to produce some graphs.                                                                   </pre>
<pre>                              default: empty                                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- censorValue:                Value indicating censored cases.                                                            </pre>
<pre>                              default: 1                                                                                </pre>
<pre>                                                                                                                        </pre>
<pre>- groups:                     Number of groups in which to categorize continuous variables for the plot.                                                            </pre>
<pre>                              default: 3                                                                                </pre>
<pre>                                                                                                                        </pre>
<pre>- method:                     Value of the METHOD= option of the PROC LIFETEST statements.                                                            </pre>
<pre>                              default: KM (Kaplan-Meier estimator)                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- alpha:                      Significance level defining the width of the confidence intervals.                                                            </pre>
<pre>                              The confidence level is equal to 1-alpha.                                                            </pre>
<pre>                              default: 0.05                                                                             </pre>
<pre>                                                                                                                        </pre>
<pre>- odspath:                    Quoted name of the path containing the files where plots should be saved.                                                            </pre>
<pre>                              This is only valid for HTML output.                                                            </pre>
<pre>                              default: none                                                                             </pre>
<pre>                                                                                                                        </pre>
<pre>- odsfile:                    Quoted name of the file where plots should be saved.                                                            </pre>
<pre>                              default: none                                                                             </pre>
<pre>                                                                                                                        </pre>
<pre>- odsfiletype:                Type of the file specified in the ODSFILE= option.                                                            </pre>
<pre>                              default: html                                                                             </pre>
<pre>                              NOTE: The default should be changed to PDF if the PDF output works with the LIFETEST procedure.                                                            </pre>
<pre>                              which currently (Aug-2015) does not for medium size datasets (e.g. 300,000 cases).                                                            </pre>
<pre>                                                                                                                        </pre>
<pre>- imagerootname:Root name to be used for the image file name generated by ODS graphics.                                                                                          </pre>
<pre>                              Each plot is stored in a file named as <imagerootname>-<TARGET>-<K>-<VAR> where                                                            </pre>
<pre>                              <K> and <VAR> are respectively the number and name of the currently analyzed variable                                                            </pre>
<pre>                              in the order they are passed to the VARCLASS= and VARNUM= parameters, starting with                                                            </pre>
<pre>                              the variables listed in VARCLASS=.                                                            </pre>
<pre>                              default: PHTestPlot                                                                       </pre>
<pre>                                                                                                                        </pre>
<pre>- log:                        Show messages in the log?                                                                 </pre>
<pre>                              Possible values: 0 => No, 1 => Yes.                                                            </pre>
<pre>                              default: 1                                                                                </pre>
<pre>                                                                                                                        </pre>
<h3>OTHER MACROS AND MODULES USED IN THIS MACRO:</h3>
<pre>- %Categorize                                                                                                           </pre>
<pre>- %GetNroElements                                                                                                       </pre>
<pre>- %ResetSASOptions                                                                                                      </pre>
<pre>- %SetSASOptions                                                                                                        </pre>
<body>
</html>
