<!DOCTYPE html>

<html>
<pre>%* MACRO %ODSOutputOpen;                                                                                                </pre>
<pre>%* Created: 01-Sep-2015;                                                                                                </pre>
<pre>%* Modified: 29-Nov-2018;                                                                                               </pre>
<pre>%* Author: Daniel Mastropietro;                                                                                          </pre>
<pre>%* Open an ODS output file for writing;                                                                                          </pre>
<pre>%* ALL paths should be UNQUOTED;                                                                                          </pre>
<pre>%* OTHER MACROS USED: %getwd;                                                                                           </pre>
<pre>%* SEE ALSO: %ODSOutputClose;                                                                                           </pre>
<pre>&rsubmit;                                                                                                               </pre>
<pre>%MACRO ODSOutputOpen(odsfile, odspath=, odsfiletype=pdf, macro=, log=0) / store des="Opens an ODS output file for writing";                                                                                          </pre>
<pre>%if %quote(&odsfile) ~= and %quote(&odsfiletype) ~= %then %do;                                                                                          </pre>
<pre>                                                                                                                        </pre>
<pre>                              %* OUTPUT PATH;                                                                           </pre>
<pre>                              %if %quote(&odspath) = %then                                                              </pre>
<pre>                              %* Use the working directory as output path;                                                            </pre>
<pre>                              %let odspath = %getwd;                                                                    </pre>
<pre>                                                                                                                        </pre>
<pre>                              %* OUTPUT TYPE;                                                                           </pre>
<pre>                              %if %upcase(%quote(&odsfiletype)) = HTML %then %do;                                                            </pre>
<pre>                              %* This distinction of HTML output is necessary because this is the only format that accepts the PATH= option...;                                                            </pre>
<pre>                              %* The reason being that the HTML output stores graphs in separate files (e.g. PNG files that are linked to the HTML output);                                                            </pre>
<pre>                              %* Note that the names of those separate files (e.g. PNG) use the IMAGENAME= option of the ODS GRAPHICS statement                                                            </pre>
<pre>                              %* as root name and are numbered with an index to avoid override (e.g. test.png, test1.png, etc.), but these numbers                                                            </pre>
<pre>                              %* may NOT be consecutive, if another HTML destination is open (like the DEFAULT HTML destination!, and therefore                                                            </pre>
<pre>                              %* depending on the number of files containing plots generated by the plotting process, the numbers may vary.                                                            </pre>
<pre>                              %* For instance, if 3 graphs are generated by the plotting process, the file names will be:                                                            </pre>
<pre>                              %* test1.png, test3.png, test5.png                                                            </pre>
<pre>                              %* because each plot is sent both to the default HTML destination and the HTML destination                                                            </pre>
<pre>                              %* that is opened by the user when calling this macro.                                                            </pre>
<pre>                              %* I DO NOT KNOW HOW TO CLOSE THE DEFAULT HTML DESTINATION (HTML CLOSE DOES NOT WORK!);                                                            </pre>
<pre>                              %* The default format of the files is PNG and can be changed using the OUTPUTFMT= option of the ODS GRAPHICS statement;                                                            </pre>
<pre>                              ods &odsfiletype path="&odspath" file="&odsfile" style=statistical;                                                            </pre>
<pre>                              %end;                                                                                     </pre>
<pre>                              %else %do;                                                                                </pre>
<pre>                              ods &odsfiletype file="&odspath/&odsfile" style=statistical;                                                            </pre>
<pre>                              %end;                                                                                     </pre>
<pre>                                                                                                                        </pre>
<pre>                              %if &log %then %do;                                                                       </pre>
<pre>                              %if %quote(&macro) ~= %then                                                               </pre>
<pre>                              %put %upcase(&macro): %upcase(&odsfiletype) file "&odsfile" opened for output by ODS.;                                                            </pre>
<pre>                              %else                                                                                     </pre>
<pre>                              %put %upcase(&odsfiletype) file "&odsfile" opened for output by ODS.;                                                            </pre>
<pre>                              %put;                                                                                     </pre>
<pre>                              %end;                                                                                     </pre>
<pre>%end;                                                                                                                   </pre>
<pre>%MEND ODSOutputOpen;                                                                                                    </pre>
<body>
</html>
